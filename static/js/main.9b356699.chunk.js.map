{"version":3,"sources":["../../src/Constants/canvas.constants.tsx","../../src/Utils/common.utils.tsx","../../src/Utils/draggable.utils.tsx","../../src/Utils/canvas.utils.tsx","../../src/Utils/draw.utils.tsx","../../src/Components/Toolbar/toolbar.component.tsx","../../src/Components/Inputs/Textarea/textarea.component.tsx","../../src/Components/Inputs/NumberInput/numberInput.component.tsx","../../src/Components/Inputs/ColorPicker/colorPicker.component.tsx","../../src/Components/Inputs/SliderInput/sliderInput.component.tsx","../../src/Components/Settings/settings.component.tsx","../../src/index.tsx","App.tsx","index.tsx"],"names":["CANVAS_COLOR_LIST","SELECTION_RESIZE_BOX_CURSORS","getSelectionBoxCords","boxCords","i","boxCord","x","y","w","h","compDimension","SELECTION_RESIZE_BOX_SIZE","SELECTION_BOX_OFFSET","FontDetector","baseFonts","document","s","defaultWidth","defaultHeight","this","detected","font","matched","isDragging","isResizing","listenMovingCanvas","isMovingCanvas","dragCompIndex","resizeBoxIndex","offset","resizePrevCompPos","prevCursorPos","DestroyDraggable","canvasDOM","onMouseDown","canvasEvent","getCanvasCursorPos","tempComponents","cwComponents","object","revComponents","comp","c","rectCollision","length","arr","index","reversedIndexOf","selectionBoxes","triggerComponentSelect","onMouseMove","cursorChangeX","cursorChangeY","cwRender","cursorChangeReverseX","cursorChangeReverseY","selectionBoxActive","onMouseUp","onKeyDown","event","tempIndex","setTimeout","removeComponent","onKeyUp","allowDrop","onDrop","id","cursorPos","boxData","type","title","description","lineWidth","fillColor","getDefaultBoxData","rect","canvasRect","top","CustomEvent","detail","component","drawRoundedRect","radius","defaultBorder","tl","tr","br","bl","borderRadius","formatBorderRadius","ctx","printAtWordWrap","fitWidth","words","text","currentLine","idx","str","lineHeight","canvasDefaultData","selectionStrokeColor","selectionLineWidth","canvasData","InitCanvas","parent","canvas","mode","data","onDataChange","parentDOM","cwMode","handleDataChange","canvasRender","components","RegisterDraggable","window","RemoveComponent","tempData","handleComponentSelect","selectedIndex","debouncRender","func","timeout","args","timer","debounce","triggerDataChange","parentDim","pixelRatio","getDevicePixelRatio","setCanvasBG","renderComponents","fontSize","padding","drawBoxComponent","box","drawSelectionHandle","Toolbar","className","draggable","onDragStart","React","Textarea","value","placeholder","onChange","useState","setData","e","NumberInput","defaultValue","min","max","onBlur","val","setVal","useEffect","handleChange","handleBlur","parseInt","ColorPicker","colors","transparentBG","showPopup","setShowPopup","boxRef","useRef","popupRef","boxBound","pickerWidth","colorBoxStyle","colorFilStyle","background","backgroundImage","ref","onClick","style","color","presetColors","width","SliderWithTooltip","createSliderWithTooltip","SliderInput","onAfterChange","Settings","canvasRef","selection","setSelection","setComponent","height","setHeight","fonts","setFonts","availableList","detector","getAvailableFontList","handleSelectionChange","key","handleComponentDataChange","newComponent","setCwMode","cwData","setCwData","createRef","parentRef","otherObject","objKeys","Object","otherKeys","objKey","Array","IsEqualObject","tabIndex","randomX","Math","randomY","strokeColor","App","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.9b356699.chunk.js","sourcesContent":["export const CANVAS_HEIGHT = 500;\nexport const MIN_CANVAS_HEIGHT = 250;\n\nexport const CANVAS_BG = '#f5f5f5';\nexport const CANVAS_COLOR_LIST = [ \n    '#ffffff', \n    '#f5f5f5', \n    '#D9E3F0',\n    '#cccccc', \n    '#697689', \n    '#555555', \n    '#000000',\n    '#ff8a65', \n    '#F47373', \n    '#37D67A', \n    '#2CCCE4', \n    '#dce775', \n    '#ba68c8', \n    'transparent',\n];\n\nexport const SELECTION_BOX_OFFSET = 3;\nexport const SELECTION_RESIZE_BOX_SIZE = 7;\nexport const SELECTION_RESIZE_BOX_CURSORS = [ \n    'nwse-resize', \n    'ns-resize', \n    'nesw-resize', \n    'ew-resize',\n    'nwse-resize',\n    'ns-resize',\n    'nesw-resize',\n    'ew-resize',\n];\n\nexport const BOX_MIN_WIDTH = 50;\nexport const BOX_MIN_HEIGHT = 50;\n\nexport const FONT_SIZE = 16;\nexport const MIN_FONT_SIZE = 8;\nexport const MAX_FONT_SIZE = 70;\nexport const FONT_FAMILY = 'Arial';\nexport const TEXT_COLOR = '#000000';\nexport const STROKE_COLOR = '#cccccc';\nexport const BORDER_RADIUS = 2;\nexport const MAX_BORDER_RADIUS = 20;\nexport const LINE_WIDTH = 1;\nexport const MAX_LINE_WIDTH = 10;","import { SELECTION_BOX_OFFSET, SELECTION_RESIZE_BOX_SIZE } from \"../Constants/canvas.constants\";\nimport { BorderRadius, BorderRadiusBase } from \"../Dtos/canvas.dtos\";\n\n/**\n * Log tag.\n */\nconst logTag = 'CanvasWorkflow:';\n\n/**\n * Debounce the given function.\n * \n * @param func Function.\n * @param timeout Timeout in ms.\n * @returns Function.\n */\nexport function debounce(func: Function, timeout = 300){\n    let timer: number;\n    return (...args: any[]) => {\n        window.clearTimeout(timer);\n        timer = window.setTimeout(() => { func.apply(this, args); }, timeout);\n    };\n}\n\n/**\n * Checks if two given objects are same \n * NOTE: Mainly used in persitance for identifying if two params are same\n * @param  {object} object\n * @param  {object} otherObject\n */\nexport function IsEqualObject(object: any, otherObject: any) {\n    let objKeys = Object.keys(object || {}),\n        otherKeys = Object.keys(otherObject || {});\n    \n    // Check length of object matches.\n    if (objKeys.length !== otherKeys.length) {\n        return false;\n    }\n\n    // Check index keys matches.\n    for( let objKey in objKeys ) {\n        if( objKeys[objKey] !== otherKeys[objKey] ) {\n            return false;\n        }\n    }\n\n    // Check array inside object.\n    for( let objKey of objKeys ) {\n        if( Array.isArray( object[objKey] ) ) {\n            if( object[objKey].length !== otherObject[objKey].length ) {\n                return false;\n            }\n\n            for( let i = 0; i < object[objKey].length; i++ ) {\n                if( object[objKey][i] !== otherObject[objKey][i] ) {\n                    return false;\n                }\n            }\n        } else if( object[objKey] !== otherObject[objKey] ) {\n            return false;\n        }\n    }\n    return true;\n}\n\n/**\n * Get reversed index of item in array.\n * \n * @param arr Arrays\n * @param item Item in array\n * @returns number\n */\nexport const reversedIndexOf = ( arr: any[], item: any): number => {\n    const { length } = arr;\n    const index = arr.indexOf(item);\n    if(index === -1){\n       return -1;\n    };\n    return length - index - 1;\n};\n\n/**\n * Format the border radius.\n * \n * @param borderRadius BorderRadius\n * @returns BorderRadiusBase\n */\nexport const formatBorderRadius = ( borderRadius?: BorderRadius ): BorderRadiusBase => {\n    const defaultBorder = { tl: 0, tr: 0, br: 0, bl: 0 };\n\n    if( typeof borderRadius === 'undefined' ) {\n        return defaultBorder;\n    }\n\n    if( typeof borderRadius !== 'number' ) {\n        return { ...defaultBorder, ...borderRadius };\n    }\n    \n    return { \n        tl: borderRadius as number, \n        tr: borderRadius as number, \n        br: borderRadius as number, \n        bl: borderRadius as number \n    };\n}\n\n/**\n * Get selection box coordinates.\n * \n * @param compDimension Component Dimension.\n * @param strokeOffset Selection stroke offset.\n * @param boxSize Box size.\n * @returns Array\n */\nexport const getSelectionBoxCords = ( compDimension: { x: number, y: number, w: number, h: number } ): { x: number, y: number, w: number, h: number }[] => {\n    let boxCords: { x: number, y: number, w: number, h: number }[] = [];\n\n    for( let i = 1; i <= 8; i++ ) {\n        let boxCord = {\n            x: 0,\n            y: 0,\n            w: SELECTION_RESIZE_BOX_SIZE,\n            h: SELECTION_RESIZE_BOX_SIZE,\n        }\n\n        if( [ 1, 7, 8 ].includes(i) ) {\n            boxCord.x = compDimension.x - SELECTION_BOX_OFFSET - (SELECTION_RESIZE_BOX_SIZE / 2);\n        } else if( [ 2, 6 ].includes(i) ) {\n            boxCord.x = compDimension.x + ( compDimension.w / 2 ) + ( SELECTION_BOX_OFFSET / 2 ) - (SELECTION_RESIZE_BOX_SIZE / 2);\n        } else if( [ 3, 4, 5 ].includes(i) ) {\n            boxCord.x = compDimension.x + compDimension.w + SELECTION_BOX_OFFSET - (SELECTION_RESIZE_BOX_SIZE / 2);\n        }\n\n        if( [ 1, 2, 3 ].includes(i) ) {\n            boxCord.y = compDimension.y - SELECTION_BOX_OFFSET - (SELECTION_RESIZE_BOX_SIZE / 2);\n        } else if( [ 4, 8 ].includes(i) ) {\n            boxCord.y = compDimension.y + ( compDimension.h / 2 ) + ( SELECTION_BOX_OFFSET / 2 ) - (SELECTION_RESIZE_BOX_SIZE / 2);\n        } else if( [ 5, 6, 7 ].includes(i) ) {\n            boxCord.y = compDimension.y + compDimension.h + SELECTION_BOX_OFFSET - (SELECTION_RESIZE_BOX_SIZE / 2);\n        }\n\n        boxCords.push( boxCord );\n    }\n\n    return boxCords;\n}\n\n/**\n * Get Device pixel ratio.\n * \n * @param ctx Canvas Rendering Context 2D.\n * @returns number\n */\nexport const getDevicePixelRatio = ( ctx: CanvasRenderingContext2D ) => {\n    let dpr = window.devicePixelRatio || 1,\n        bsr = ( ctx as any ).webkitBackingStorePixelRatio ||\n            ( ctx as any ).mozBackingStorePixelRatio ||\n            ( ctx as any ).msBackingStorePixelRatio ||\n            ( ctx as any ).oBackingStorePixelRatio ||\n            ( ctx as any ).backingStorePixelRatio || 1;\n\n    return dpr / bsr;\n};\n\ninterface FontDetector {\n\n}\n// https://stackoverflow.com/a/3368855/9784022\n/**\n * JavaScript code to detect available availability of a\n * particular font in a browser using JavaScript and CSS.\n */\nvar FontDetector = function() {\n    // a font will be compared against all the three default fonts.\n    // and if it doesn't match all 3 then that font is not available.\n    const baseFonts = ['monospace', 'sans-serif', 'serif'];\n\n    //we use m or w because these two characters take up the maximum width.\n    // And we use a LLi so that the same matching fonts can get separated\n    const testString = \"mmmmmmmmmmlli\";\n\n    //we test using 72px font size, we may use any size. I guess larger the better.\n    const testSize = '72px';\n\n    const h = document.getElementsByTagName(\"body\")[0];\n\n    // create a SPAN in the document to get the width of the text we use to test\n    const s = document.createElement(\"span\");\n    s.style.fontSize = testSize;\n    s.innerHTML = testString;\n    let defaultWidth = {};\n    let defaultHeight = {};\n    for (let index in baseFonts) {\n        //get the default width for the three base fonts\n        s.style.fontFamily = baseFonts[index];\n        h.appendChild(s);\n        defaultWidth[baseFonts[index]] = s.offsetWidth; //width for the default font\n        defaultHeight[baseFonts[index]] = s.offsetHeight; //height for the defualt font\n        h.removeChild(s);\n    }\n\n    function detect(font: string) {\n        let detected = false;\n        for (let index in baseFonts) {\n            s.style.fontFamily = font + ',' + baseFonts[index]; // name of the font along with the base font for fallback.\n            h.appendChild(s);\n            const matched = (s.offsetWidth != defaultWidth[baseFonts[index]] || s.offsetHeight != defaultHeight[baseFonts[index]]);\n            h.removeChild(s);\n            detected = detected || matched;\n        }\n        return detected;\n    }\n\n    this.detect = detect;\n    return this;\n} as any;\n\n/**\n * Get list of available fonts.\n * \n * @returns string[]\n */\nexport const getAvailableFontList = (): string[] => {\n    let availableList: string[] = [];\n    let detector = new FontDetector();\n    const fontList = [\n        // Windows 10\n        'Arial', 'Arial Black', 'Bahnschrift', 'Calibri', 'Cambria', 'Cambria Math', 'Candara', 'Comic Sans MS', 'Consolas', 'Constantia', 'Corbel', 'Courier New', 'Ebrima', 'Franklin Gothic Medium', 'Gabriola', 'Gadugi', 'Georgia', 'HoloLens MDL2 Assets', 'Impact', 'Ink Free', 'Javanese Text', 'Leelawadee UI', 'Lucida Console', 'Lucida Sans Unicode', 'Malgun Gothic', 'Marlett', 'Microsoft Himalaya', 'Microsoft JhengHei', 'Microsoft New Tai Lue', 'Microsoft PhagsPa', 'Microsoft Sans Serif', 'Microsoft Tai Le', 'Microsoft YaHei', 'Microsoft Yi Baiti', 'MingLiU-ExtB', 'Mongolian Baiti', 'MS Gothic', 'MV Boli', 'Myanmar Text', 'Nirmala UI', 'Palatino Linotype', 'Segoe MDL2 Assets', 'Segoe Print', 'Segoe Script', 'Segoe UI', 'Segoe UI Historic', 'Segoe UI Emoji', 'Segoe UI Symbol', 'SimSun', 'Sitka', 'Sylfaen', 'Symbol', 'Tahoma', 'Times New Roman', 'Trebuchet MS', 'Verdana', 'Webdings', 'Wingdings', 'Yu Gothic',\n        // macOS\n        'American Typewriter', 'Andale Mono', 'Arial', 'Arial Black', 'Arial Narrow', 'Arial Rounded MT Bold', 'Arial Unicode MS', 'Avenir', 'Avenir Next', 'Avenir Next Condensed', 'Baskerville', 'Big Caslon', 'Bodoni 72', 'Bodoni 72 Oldstyle', 'Bodoni 72 Smallcaps', 'Bradley Hand', 'Brush Script MT', 'Chalkboard', 'Chalkboard SE', 'Chalkduster', 'Charter', 'Cochin', 'Comic Sans MS', 'Copperplate', 'Courier', 'Courier New', 'Didot', 'DIN Alternate', 'DIN Condensed', 'Futura', 'Geneva', 'Georgia', 'Gill Sans', 'Helvetica', 'Helvetica Neue', 'Herculanum', 'Hoefler Text', 'Impact', 'Lucida Grande', 'Luminari', 'Marker Felt', 'Menlo', 'Microsoft Sans Serif', 'Monaco', 'Noteworthy', 'Optima', 'Palatino', 'Papyrus', 'Phosphate', 'Rockwell', 'Savoye LET', 'SignPainter', 'Skia', 'Snell Roundhand', 'Tahoma', 'Times', 'Times New Roman', 'Trattatello', 'Trebuchet MS', 'Verdana', 'Zapfino',\n    ].sort();\n\n    for( let font of fontList ) {\n        if( ! availableList.includes( font ) && detector.detect( font ) ) {\n            availableList.push( font );\n        }\n    }\n\n    return availableList;\n}\n\n/**\n * Custom Log with tag.\n * \n * @param message Any values to log.\n */\nexport const log = ( ...message: any[] ): void => {\n    console.log( logTag, ...message );\n}\n\nexport const getDefaultBoxData = ( x?: number, y?: number ) => {\n    let boxData = { \n        type: 'box',\n        title: 'Workflow',\n        description: 'Your workflow description here.',\n        x: 100,\n        y: 100,\n        w: 150,\n        h: 100,\n        lineWidth: 1,\n        fillColor: '#ffffff',\n    };\n\n    if( typeof x !== 'undefined' ) {\n        boxData.x = x - ( boxData.w / 2 );\n    }\n    if( typeof y !== 'undefined' ) {\n        boxData.y = y - ( boxData.h / 2 );\n    }\n\n    return boxData;\n}","import { BOX_MIN_HEIGHT, BOX_MIN_WIDTH, SELECTION_RESIZE_BOX_CURSORS } from \"../Constants/canvas.constants\";\nimport { BoxComponent, CanvasComponent } from \"../Dtos/canvas.dtos\";\nimport { getDefaultBoxData, getSelectionBoxCords, reversedIndexOf } from \"./common.utils\";\n\nlet cwRender: Function;\nlet canvasDOM: HTMLCanvasElement;\nlet cwComponents: CanvasComponent[];\nlet tempComponents: CanvasComponent[];\n\nlet removeComponent: ( index: number ) => void;\n\nlet isDragging = false;\nlet isResizing = false;\nlet listenMovingCanvas = false;\nlet isMovingCanvas = false;\n\nlet dragCompIndex = -1;\nlet resizeBoxIndex = -1;\n\nlet offset = {x: 0, y: 0};\nlet resizePrevCompPos = {x: 0, y: 0, w: 0, h: 0};\nlet prevCursorPos = {x: 0, y: 0};\n\n/**\n * Register draggable events.\n * \n * @param canvas Canvas\n * @param components Component array\n * @param render Render function of canvas.\n */\nexport const RegisterDraggable = ( canvas: HTMLCanvasElement, components: CanvasComponent[] = [], render: Function, RemoveComponent: ( index: number ) => void ): void => {\n    cwComponents = components;\n    canvasDOM = canvas;\n    cwRender = render;\n    removeComponent = RemoveComponent;\n\n    canvasDOM.addEventListener('mousedown', onMouseDown );\n    canvasDOM.addEventListener('mousemove', onMouseMove );\n    canvasDOM.addEventListener('keydown', onKeyDown );\n    canvasDOM.addEventListener('keyup', onKeyUp );\n    canvasDOM.addEventListener('drop', onDrop );\n    canvasDOM.addEventListener('dragover', allowDrop );\n}\n\n/**\n * Destroy draggable events.\n */\nexport const DestroyDraggable = (): void => {\n    if( canvasDOM ) {\n        canvasDOM.removeEventListener('mousedown', onMouseDown );\n        canvasDOM.removeEventListener('mousemove', onMouseMove );\n        canvasDOM.removeEventListener('keypress', onKeyDown );\n        canvasDOM.removeEventListener('dragover', allowDrop );\n    }\n}\n\n/**\n * Mouse down event.\n * \n * @param event MouseEvent\n */\nconst onMouseDown = ( event: MouseEvent ): void => {\n    // if( ! cwComponents.length ) return;\n\n    const canvasEvent = getCanvasCursorPos( event );\n\n    // Move canvas\n    if( listenMovingCanvas && ! isMovingCanvas ) {\n        isMovingCanvas = true;\n        prevCursorPos = { ...canvasEvent };\n        tempComponents = cwComponents.map(object => ({ ...object }));\n        canvasDOM.style.cursor = 'grabbing';\n        canvasDOM.addEventListener('mouseup', onMouseUp );\n        return;\n    }\n\n    const revComponents = [ ...cwComponents ].reverse();\n    // Loop each components for hit.\n    for( let comp of revComponents ) {\n        let compDimension = {\n            x: comp.x,\n            y: comp.y,\n            w: 0,\n            h: 0,\n        }\n\n        switch( comp.type ) {\n            case 'box':\n                const c = comp as BoxComponent;\n                compDimension.w = c.w;\n                compDimension.h = c.h;\n                break;\n        }\n\n        if( ! isDragging && rectCollision(canvasEvent.x, canvasEvent.y, compDimension ) ) {\n            isDragging = true;\n            dragCompIndex = reversedIndexOf( revComponents, comp );\n            offset.x = canvasEvent.x - comp.x;\n            offset.y = canvasEvent.y - comp.y;\n\n            canvasDOM.addEventListener('mouseup', onMouseUp );\n            break;\n        }\n\n        if( ! isResizing && dragCompIndex !== -1 ) {\n            const selectionBoxes = getSelectionBoxCords( compDimension );\n            // Loop each selection boxes for hit.\n            selectionBoxes.every( ( box, index ) => {\n                if( rectCollision(canvasEvent.x, canvasEvent.y, box ) ) {\n                    isResizing = true;\n                    prevCursorPos = { ...canvasEvent };\n                    resizePrevCompPos = { ...compDimension };\n                    resizeBoxIndex = index;\n\n                    canvasDOM.addEventListener('mouseup', onMouseUp );\n                    return false;\n                }\n\n                return true;\n            } )\n            // Break loop for components if resizing.\n            if( isResizing ) {\n                break;\n            }\n        }\n    }\n\n    if( ! isDragging && ! isResizing ) {\n        dragCompIndex = -1;\n        resizeBoxIndex = -1;\n    }\n    triggerComponentSelect();\n}\n\n/**\n * Mouse move event.\n * \n * @param event MouseEvent\n */\nconst onMouseMove = ( event: MouseEvent ): void => {\n    const canvasEvent = getCanvasCursorPos( event );\n\n    if( listenMovingCanvas ) {\n        if( isMovingCanvas ) {\n\n            // Move canvas.\n            let cursorChangeX = prevCursorPos.x - canvasEvent.x;\n            let cursorChangeY = prevCursorPos.y - canvasEvent.y;\n\n            for( let index = 0; index < cwComponents.length; index++ ) {\n                cwComponents[index].x = tempComponents[index].x - cursorChangeX;\n                cwComponents[index].y = tempComponents[index].y - cursorChangeY;\n            }\n            cwRender();\n        }\n    } else if( isDragging && ! isResizing && dragCompIndex !== -1 ) {\n\n        // Drag component.\n        cwComponents[dragCompIndex].x = canvasEvent.x - offset.x;\n        cwComponents[dragCompIndex].y = canvasEvent.y - offset.y;\n        cwRender();\n    } else if( isResizing && dragCompIndex !== -1 ) {\n\n        // Resize box draw.\n        let cursorChangeX = prevCursorPos.x - canvasEvent.x;\n        let cursorChangeY = prevCursorPos.y - canvasEvent.y;\n\n        let cursorChangeReverseX = canvasEvent.x - prevCursorPos.x;\n        let cursorChangeReverseY = canvasEvent.y - prevCursorPos.y;\n\n        if( [ 0, 6, 7 ].includes( resizeBoxIndex ) ) {\n            cwComponents[dragCompIndex].x = resizePrevCompPos.x - cursorChangeX;\n            cwComponents[dragCompIndex].w = resizePrevCompPos.w + cursorChangeX;\n        }\n        if( [ 0, 1, 2 ].includes( resizeBoxIndex ) ) {\n            cwComponents[dragCompIndex].y = resizePrevCompPos.y - cursorChangeY;\n            cwComponents[dragCompIndex].h = resizePrevCompPos.h + cursorChangeY;\n        }\n        if( [ 2, 3, 4 ].includes( resizeBoxIndex ) ) {\n            cwComponents[dragCompIndex].w = resizePrevCompPos.w + cursorChangeReverseX;\n        }\n        if( [ 4, 5, 6 ].includes( resizeBoxIndex ) ) {\n            cwComponents[dragCompIndex].h = resizePrevCompPos.h + cursorChangeReverseY;\n        }\n\n        // Maintain minimum weidth and height.\n        if( cwComponents[dragCompIndex].w <= BOX_MIN_WIDTH ) {\n            cwComponents[dragCompIndex].w = BOX_MIN_WIDTH;\n        }\n        if( cwComponents[dragCompIndex].h <= BOX_MIN_HEIGHT ) {\n            cwComponents[dragCompIndex].h = BOX_MIN_HEIGHT;\n        }\n\n        cwRender();\n    } else {\n        canvasDOM.style.cursor = 'default';\n        cwComponents.every( ( comp, index ) => {\n            let compDimension = {\n                x: comp.x,\n                y: comp.y,\n                w: 0,\n                h: 0,\n            }\n    \n            switch( comp.type ) {\n                case 'box':\n                    const c = comp as BoxComponent;\n                    compDimension.w = c.w;\n                    compDimension.h = c.h;\n                    break;\n            }\n\n            if( rectCollision(canvasEvent.x, canvasEvent.y, compDimension ) ) {\n                canvasDOM.style.cursor = 'move'; // On hover over draggable box.\n                return false;\n            }\n\n            let selectionBoxActive = false;\n            if( index === dragCompIndex ) {\n                const selectionBoxes = getSelectionBoxCords( compDimension );\n                selectionBoxes.every( ( box, index ) => {\n                    if( rectCollision(canvasEvent.x, canvasEvent.y, box ) ) {\n                        canvasDOM.style.cursor = SELECTION_RESIZE_BOX_CURSORS[index] || 'move';\n                        selectionBoxActive = true;\n                        return false;\n                    }\n                    return true;\n                } )\n            }\n\n            if( selectionBoxActive ) return false;\n            return true;\n        } );\n    }\n}\n\n/**\n * Mouse up event.\n */\nconst onMouseUp = (): void => {\n    if ( isMovingCanvas ) {\n        canvasDOM.style.cursor = 'grab';\n    }\n    isDragging = false;\n    isResizing = false;\n    isMovingCanvas = false;\n    tempComponents = [];\n    canvasDOM.removeEventListener('mouseup', onMouseUp );\n}\n\n/**\n * Key down event.\n * \n * @param event KeyboardEvent\n */\nconst onKeyDown = ( event: KeyboardEvent ): void => {\n    if( event.key === ' ' && ! listenMovingCanvas ) {\n        event.preventDefault();\n        canvasDOM.style.cursor = 'grab'\n        listenMovingCanvas = true;\n    } if( ( event.key.toLowerCase() === 'delete' || event.key.toLowerCase() === 'backspace' ) && dragCompIndex !== -1 ) {\n        event.preventDefault();\n        const tempIndex = dragCompIndex;\n        dragCompIndex = -1;\n        setTimeout( () => {\n            removeComponent( tempIndex );\n            triggerComponentSelect();\n        }, 100 )\n    }\n}\n\n/**\n * Key up event.\n * \n * @param event KeyboardEvent\n */\nconst onKeyUp = ( event: KeyboardEvent ): void => {\n    if( event.key === ' ' ) {\n        listenMovingCanvas = false;\n        isMovingCanvas = false;\n        tempComponents = [];\n        canvasDOM.style.cursor = 'default'\n    }\n}\n\n/**\n * Allow drop over canvas.\n * \n * @param ev Event\n */\nconst allowDrop = ( event: any ): any => {\n    event.preventDefault();\n} \n\nconst onDrop = ( event: any ) => {\n    event.preventDefault();\n    if( event.dataTransfer ) {\n        const id = event.dataTransfer.getData('id');\n        const cursorPos = getCanvasCursorPos( event );\n\n        switch( id ) {\n            case 'box':\n                const length = cwComponents.push( getDefaultBoxData( cursorPos.x, cursorPos.y ) );\n                dragCompIndex = length - 1;\n                triggerComponentSelect();\n                cwRender();\n                break;\n        }\n    }\n\n}\n\n/**\n * Rectangular collision detection.\n * \n * @param x Cursor X.\n * @param y Cursor Y\n * @param rect Rectangle coords.\n * @returns boolean\n */\nconst rectCollision = ( x: number, y: number, rect: { x: number, y: number, w: number, h: number } ): boolean => {\n    if(\n        x > rect.x\n        && y > rect.y\n        && x < ( rect.w + rect.x )\n        && y < ( rect.h + rect.y )\n    ) {\n        return true;\n    }\n    return false;\n}\n\n/**\n * Get cursor position in canvas.\n * \n * @param event MouseEvent\n * @returns object\n */\nconst getCanvasCursorPos = ( event: MouseEvent ): { x: number, y: number} => {\n    const canvasRect = canvasDOM.getBoundingClientRect();\n    return { x: event.clientX - canvasRect.left, y: event.clientY - canvasRect.top }\n}\n\n/**\n * Trigger component select event. 'cwComponentSelected'\n */\nconst triggerComponentSelect = (): void => {\n    if( canvasDOM ) {\n        canvasDOM.dispatchEvent( new CustomEvent('cwComponentSelected', { \n            detail:  { \n                index: dragCompIndex, \n                component: cwComponents[dragCompIndex] \n            } \n        }) );\n    }\n}\n\n/**\n * Trigger component moving event. 'cwComponentMoving'\n */\n// const triggerComponentMoving = (): void => {\n//     if( canvasDOM ) {\n//         canvasDOM.dispatchEvent( new CustomEvent('cwComponentMoving', { \n//             detail:  { \n//                 components: cwComponents,\n//             }\n//         }) );\n//     }\n// }","import { BoxComponent, CanvasComponent, CanvasData } from \"../Dtos/canvas.dtos\";\nimport { debounce, getDevicePixelRatio, log } from \"./common.utils\";\nimport { DestroyDraggable, RegisterDraggable } from \"./draggable.utils\";\nimport { TimeLogger } from \"./timeLogger.utils\";\nimport { drawBoxComponent, drawSelectionHandle } from './draw.utils';\nimport { CANVAS_BG, CANVAS_HEIGHT } from \"../Constants/canvas.constants\";\n\nlet forceStopDebug = true;\nlet debug = ! forceStopDebug && process.env.NODE_ENV === 'development';\n\nlet parentDOM: HTMLDivElement;\nlet canvasDOM: HTMLCanvasElement;\nlet ctx: CanvasRenderingContext2D | null;\nlet handleDataChange: ( data: CanvasData ) => void;\nlet cwMode: 'editor' | 'viewer';\n\nlet canvasDefaultData = {\n    selectionStrokeColor: '#7f7f7f',\n    selectionLineWidth: 1,\n}\n\nlet canvasData: CanvasData = {}\nlet selectedIndex: number;\n\ninterface InitCanvasProps {\n    parent: HTMLDivElement,\n    canvas: HTMLCanvasElement,\n    mode?: 'editor' | 'viewer',\n    data?: CanvasData,\n    updateData?: ( data: CanvasData ) => void,\n    onDataChange?: ( data: CanvasData ) => void\n}\n\n/**\n * Initialize Canvas.\n * \n * @param parent Parent DOM.\n * @param canvas Main Canvas DOM.\n * @param mode Mode of canvas workflow.\n * @param data Canvas Data. \n */\nexport const InitCanvas = (\n    { \n        parent,\n        canvas,\n        mode,\n        data,\n        onDataChange,\n    } : InitCanvasProps\n) => {\n    parentDOM = parent;\n    canvasDOM = canvas;\n    cwMode = mode || 'editor';\n    ctx = canvas.getContext(\"2d\");\n\n    if( onDataChange ) {\n        handleDataChange = onDataChange;\n    }\n\n    if( data ) {\n        canvasData = data;\n    }\n    \n    canvasRender( false );\n\n    if( cwMode === 'editor' && canvasData ) {\n        RegisterDraggable( canvasDOM, canvasData.components, canvasRender, RemoveComponent );\n    } else {\n        DestroyDraggable();\n    }\n    window.addEventListener( 'resize', debouncRender );\n    canvasDOM.addEventListener( 'cwComponentSelected', handleComponentSelect );\n}\n\n/**\n * Destroy the canvas events.\n */\nexport const DestroyCanvas = () => {\n    window.removeEventListener( 'resize', debouncRender );\n    DestroyDraggable();\n    if( debug ) {\n        log('Canvas Destroyed');\n    }\n}\n\nexport const RemoveComponent = ( index: number ) => {\n    if( canvasData?.components ) {\n        let tempData = { ...canvasData };\n        tempData.components = tempData.components?.filter( ( _, i ) => {\n            return i !== index;\n        } );\n        canvasData = tempData;\n        handleDataChange( tempData );\n    }\n}\n\n/**\n * Clear Canvas.\n */\nexport const ClearCanvas = () => {\n    if( canvasDOM && ctx ) {\n        ctx.clearRect(0, 0, canvasDOM.width, canvasDOM.height);\n        if( debug ) {\n            log('Canvas Cleared!');\n        }\n    }\n}\n\nconst handleComponentSelect = ( event: CustomEvent ) => {\n    if( selectedIndex !== event.detail.index ) {\n        selectedIndex = event.detail.index;\n        canvasRender( false );\n    }\n}\n\n/**\n * Debounce the render function for performance optimization.\n */\nconst debouncRender = debounce( () => canvasRender() );\n\n/**\n * Main render function for canvas.\n */\nexport const canvasRender = ( triggerDataChange = true ) => {\n    if( parentDOM && canvasDOM && ctx ) {\n        let parentDim = parentDOM.getBoundingClientRect();\n        let pixelRatio = getDevicePixelRatio( ctx ); // Device pixel ratio.\n\n        // Manage pixel ratio of canvas according to device pixel ratio.\n        canvasDOM.width = parentDim.width * pixelRatio;\n        canvasDOM.height = ( canvasData.height || CANVAS_HEIGHT ) * pixelRatio;\n        canvasDOM.style.width = parentDim.width + \"px\";\n        canvasDOM.style.height = ( canvasData.height || CANVAS_HEIGHT ) + \"px\";\n        ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n\n        ClearCanvas();\n    \n        if( debug ) {\n            log('Rendering...');\n            log('Data:', {canvasData, canvasDefaultData} );\n            TimeLogger.start();\n        }\n        \n        setCanvasBG();\n\n        if( canvasData?.components ) {\n            canvasData.components.forEach( ( component ) => {\n                renderComponents(component);\n            } );\n        }\n\n        if( debug ) {\n            TimeLogger.stop('Render');\n            log('Render Completed');\n        }\n\n        if( triggerDataChange ) {\n            handleDataChange( canvasData );\n        }\n    }\n}\n\n/**\n * Fill background of canvas.\n */\nconst setCanvasBG = () => {\n    if( canvasDOM && ctx ) {\n        ctx.translate(0.5, 0.5); // Smoothening canvas.\n        ctx.fillStyle = canvasData.background || CANVAS_BG;\n        ctx.fillRect(0, 0, canvasDOM.width, canvasDOM.height);\n    }\n}\n\n/**\n * Render component in canvas.\n * @param component Canvas Component\n */\nconst renderComponents = ( component: CanvasComponent ) => {\n    processBaseComponent( component );\n    switch( component.type ) {\n        case 'box':\n            drawBoxComponent( component as BoxComponent, canvasDefaultData, ctx );\n            break;\n    }\n    drawSelectionHandle( component, canvasData, selectedIndex, canvasDefaultData, cwMode, ctx );\n}\n\n/**\n * Process Base of component.\n * \n * @param component Canvas Component.\n */\nconst processBaseComponent = ( component: CanvasComponent ) => {\n    // Register editor mode.\n    if( cwMode === 'editor' ) {\n        \n    }\n}","import { BORDER_RADIUS, FONT_FAMILY, FONT_SIZE, LINE_WIDTH, SELECTION_BOX_OFFSET, STROKE_COLOR, TEXT_COLOR } from \"../Constants/canvas.constants\";\nimport { BorderRadius, BoxComponent, CanvasComponent, CanvasData } from \"../Dtos/canvas.dtos\";\nimport { formatBorderRadius, getSelectionBoxCords, log } from \"./common.utils\";\n\n\n/**\n * Draw Box component.\n * \n * @param component Box Component\n * @returns void\n */\nexport const drawBoxComponent = ( component: BoxComponent, canvasDefaultData: any,  ctx?: CanvasRenderingContext2D | null ) => {\n    if( ! ctx ) return;\n\n    const padding = 5;\n    const fontSize = component.fontSize || FONT_SIZE;\n    const borderRadius = typeof component.borderRadius !== \"undefined\" ? component.borderRadius : BORDER_RADIUS ;\n\n    ctx.save(); // Save the default state to restore later.\n    ctx.beginPath();\n    drawRoundedRect( ctx, component.x, component.y, component.w, component.h, borderRadius );\n    if( component.fillColor ) {\n        // Draw box fill\n        ctx.fillStyle = component.fillColor || 'transparent';\n        ctx.fill();\n    }\n\n    // Draw box stroke or border.\n    ctx.lineWidth = component.lineWidth || LINE_WIDTH;\n    ctx.strokeStyle = component.strokeColor || STROKE_COLOR;\n    ctx.stroke();\n    ctx.clip(); // Clip inner elements inside box.\n\n    // Draw box text.\n    ctx.font = `bold ${fontSize}px ${component.fontFamily || FONT_FAMILY}`;\n    ctx.fillStyle = component.textColor || TEXT_COLOR;\n    ctx.fillText(\n        component.title, \n        component.x + padding + ctx.lineWidth, \n        component.y + padding + fontSize + ctx.lineWidth - 5,\n    );\n    \n    if( component.description ) {\n        ctx.font = `${fontSize}px ${component.fontFamily || FONT_FAMILY}`;\n        printAtWordWrap(\n            ctx,\n            component.description,\n            component.x + padding + ctx.lineWidth,\n            component.y + (padding * 2) + (fontSize * 2) + ctx.lineWidth - 5,\n            fontSize,\n            component.w - (padding * 2) - ctx.lineWidth,\n        );\n    }\n    ctx.restore(); // Restore default state.\n}\n\n\nexport const drawRoundedRect = ( ctx: CanvasRenderingContext2D, x: number, y: number, width: number, height: number, borderRadius?: BorderRadius ) => {\n    const radius = formatBorderRadius( borderRadius );\n    ctx.moveTo(x + radius.tl, y);\n    ctx.lineTo(x + width - radius.tr, y);\n    ctx.quadraticCurveTo(x + width, y, x + width, y + radius.tr);\n    ctx.lineTo(x + width, y + height - radius.br);\n    ctx.quadraticCurveTo(x + width, y + height, x + width - radius.br, y + height);\n    ctx.lineTo(x + radius.bl, y + height);\n    ctx.quadraticCurveTo(x, y + height, x, y + height - radius.bl);\n    ctx.lineTo(x, y + radius.tl);\n    ctx.quadraticCurveTo(x, y, x + radius.tl, y);\n    ctx.closePath();\n}\n\n/**\n * Draw box selection border or indicator.\n * \n * @param component Canvas Component\n */\nexport const drawSelectionHandle = ( component: CanvasComponent, canvasData: CanvasData, selectedIndex: number, canvasDefaultData: any, cwMode: 'editor' | 'viewer', ctx?: CanvasRenderingContext2D | null ) => {\n    if( \n        ctx \n        && cwMode === 'editor'\n        && selectedIndex > -1 \n        && canvasData.components?.length \n        && selectedIndex === canvasData.components.indexOf(component) \n    ) {\n        let dashedLine = true;\n        let compDimension = {\n            x: component.x,\n            y: component.y,\n            w: 0,\n            h: 0,\n        }\n\n        switch( component.type ) {\n            case 'box':\n                const comp = component as BoxComponent;\n                compDimension.w = comp.w;\n                compDimension.h = comp.h;\n                // dashedLine = false;\n                break;\n        }\n\n        // Draw border for selections.\n        ctx.save();\n        ctx.beginPath();\n        ctx.lineWidth = canvasData.selectionLineWidth || canvasDefaultData.selectionLineWidth;\n        if( dashedLine ) {\n            ctx.setLineDash([5, 5])\n        }\n        ctx.strokeStyle = canvasData.selectionStrokeColor || canvasDefaultData.selectionStrokeColor;\n        ctx.rect( \n            compDimension.x - SELECTION_BOX_OFFSET, \n            compDimension.y - SELECTION_BOX_OFFSET,\n            compDimension.w + (SELECTION_BOX_OFFSET * 2),\n            compDimension.h + (SELECTION_BOX_OFFSET * 2),\n        )\n        ctx.stroke();\n        ctx.restore();\n\n        // Draw border points\n        ctx.save();\n        ctx.beginPath();\n        ctx.fillStyle = canvasData.selectionStrokeColor || canvasDefaultData.selectionStrokeColor;\n        \n        const selectionBoxes = getSelectionBoxCords( compDimension );\n        for( let box of selectionBoxes ) {\n            ctx.rect( box.x, box.y, box.w, box.h );\n        }\n\n        ctx.fill();\n        ctx.restore();\n    }\n}\n\nexport const printAtWordWrap = ( ctx: CanvasRenderingContext2D , text: string, x: number, y: number, lineHeight: number, fitWidth?: number) => {\n    fitWidth = fitWidth || 0;\n    \n    if (fitWidth <= 0)\n    {\n        ctx.fillText( text, x, y );\n        return;\n    }\n    var words = text.split(' ');\n    var currentLine = 0;\n    var idx = 1;\n    while (words.length > 0 && idx <= words.length)\n    {\n        var str = words.slice(0,idx).join(' ');\n        var w = ctx.measureText(str).width;\n        if ( w > fitWidth )\n        {\n            if (idx==1)\n            {\n                idx=2;\n            }\n            ctx.fillText( words.slice(0,idx-1).join(' '), x, y + (lineHeight * currentLine) );\n            currentLine++;\n            words = words.splice(idx-1);\n            idx = 1;\n        }\n        else\n        {idx++;}\n    }\n    if  (idx > 0)\n        ctx.fillText( words.join(' '), x, y + (lineHeight * currentLine) );\n}","import React from 'react'\nimport { ReactComponent as BoxSvg } from '../../Assets/Images/workflowBox.svg'  ;\nimport './toolbar.component.scss';\n\nconst Toolbar = () => {\n\n    const handleDragStart = ( event: any ) => {\n        event.dataTransfer.setData(\"id\", event.target.id );\n    }\n\n    return (\n        <div className='cw-toolbar'>\n            <div className='toolbar-standard'>\n                <div className='title'>Standard Shapes</div>\n                <div className='tools'>\n                    <div id='box' className='tool-item' draggable=\"true\" onDragStart={ handleDragStart }>\n                        <BoxSvg/>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n\nexport default Toolbar\n","import React, { useState } from 'react';\nimport './textarea.component.scss';\n\nconst Textarea = (\n    { \n        value, \n        placeholder, \n        onChange \n    }: { \n        value?: string, \n        placeholder?: string,\n        onChange?: ( value: string ) => void \n    }\n) => {\n    const [data, setData] = useState(value);\n\n    return (\n        <div className=\"textarea-wrap\" data-replicated-value={data}>\n            <textarea placeholder={placeholder} onChange={(e) => { setData( e.target.value ); onChange && onChange( e.target.value ) } } value={data}></textarea>\n        </div>\n    )\n}\n\nexport default Textarea;\n","import React, { ChangeEvent, useEffect, useState } from 'react'\n\ninterface NumberInputProps {\n    defaultValue?: number, \n    value?: number, \n    min?: number,\n    max?: number,\n    placeholder?: string,\n    onChange?: ( value: number ) => void,\n    onBlur?: ( value: number ) => void,\n}\n\nconst NumberInput = ({ \n    defaultValue, \n    value, \n    min,\n    max,\n    placeholder,\n    onChange,\n    onBlur, \n}: NumberInputProps ) => {\n\n    const [val, setVal] = useState( defaultValue || 0 );\n\n    useEffect(() => {\n        if( value ) {\n            setVal( value );\n        }\n    }, [value])\n\n    const handleChange = ( data: number ) => {\n        if( typeof onChange !== 'undefined' ){\n            onChange( data );\n        }\n        setVal( data );\n    }\n\n    const handleBlur = ( data: number ) => {\n        if( typeof min !== 'undefined' && data < min ) data = min;\n        if( typeof max !== 'undefined' && data > max ) data = max;\n\n        if( typeof onBlur !== 'undefined' ) {\n            onBlur( data );\n        }\n        setVal( data );\n    }\n\n    return (\n        <input \n            type='number' \n            value={val} \n            placeholder={placeholder} \n            onChange={ ( e ) => handleChange( parseInt(e.target.value) ) } \n            onBlur={ ( e ) => handleBlur( parseInt(e.target.value) ) } \n        />\n    )\n}\n\nexport default NumberInput\n","import React, { Fragment, useEffect, useRef, useState } from 'react'\nimport { SketchPicker, ColorResult } from 'react-color';\nimport './colorPicker.component.scss';\n\ninterface ColorPickerProps {\n    type?: 'fill' | 'stroke',\n    value?: string,\n    colors?: string[],\n    onChange?: ( value: string ) => void;\n}\n\nconst ColorPicker = ({ type = 'fill', colors, value = '#00000000', onChange }: ColorPickerProps ) => {\n\n    const pickerWidth = 172;\n    const transparentBG = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==\";\n\n    const [showPopup, setShowPopup] = useState(false);\n    const [val, setVal] = useState(value);\n\n    const boxRef = useRef<HTMLDivElement>(null);\n    const popupRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n        if( boxRef.current && popupRef.current ) {\n            const boxBound = boxRef.current.getBoundingClientRect();\n            popupRef.current.style.left = (boxBound.x + (boxBound.width / 2) - (pickerWidth / 2) - 5) + 'px';\n            popupRef.current.style.top = (boxBound.y + boxBound.height + 5) + 'px';\n        }\n    }, [boxRef.current, popupRef.current, showPopup]);\n\n    const handleChange = ( color: ColorResult ) => {\n        if( val !== color.hex && typeof onChange === 'function' ) {\n            onChange( color.hex );\n        }\n        setVal( color.hex );\n    }\n\n    let colorBoxStyle: {} = {};\n    let colorFilStyle: {} = { background: val };\n\n    if( type === 'stroke' ) {\n        if( val === 'transparent' || val === '#00000000' ) {\n            colorBoxStyle = { backgroundImage: `url(${transparentBG})` };\n        } else {\n            colorBoxStyle = { background: val};\n        }\n        colorFilStyle = {};\n    } else {\n        if( val === 'transparent' || val === '#00000000' ) {\n            colorFilStyle = { background: '#ffffff', backgroundImage: `url(${transparentBG})` };\n        }\n    }\n\n\n    return (\n        <div className='color-picker'>\n            <div ref={boxRef} className='color-box' onClick={ () => setShowPopup( ! showPopup ) } style={colorBoxStyle}>\n                <div className='color-fill' style={colorFilStyle} />\n            </div>\n            <div ref={popupRef} className={`popup`}>\n                { showPopup && <Fragment>\n                    <div className='popup-cover' onClick={ () => setShowPopup( false ) }/>\n                    <SketchPicker\n                        color={val}\n                        presetColors={colors && colors}\n                        width={`${pickerWidth}px`} \n                        onChange={handleChange}\n                    />\n                </Fragment>}\n            </div>\n        </div>\n    )\n}\n\nexport default ColorPicker\n","import React from 'react'\nimport Slider, { createSliderWithTooltip } from 'rc-slider';\nimport 'rc-slider/assets/index.css';\nimport './sliderInput.component.scss';\n\ninterface SliderProps {\n    value?: number;\n    min?: number;\n    max?:number;\n    onChange?: ( value: number ) => void;\n    onAfterChange?: ( value: number ) => void;\n}\n\nconst SliderWithTooltip = createSliderWithTooltip(Slider);\n\nconst SliderInput = ({ value, min, max, onChange, onAfterChange } : SliderProps) => {\n    return (\n        <SliderWithTooltip defaultValue={value} min={min} max={max} onChange={onChange} onAfterChange={onAfterChange} />\n    )\n}\n\nexport default SliderInput\n","import React, { useEffect, useState } from 'react'\nimport { \n    CANVAS_BG, \n    CANVAS_COLOR_LIST, \n    CANVAS_HEIGHT, \n    FONT_FAMILY, \n    FONT_SIZE, \n    MIN_CANVAS_HEIGHT, \n    MIN_FONT_SIZE, \n    MAX_FONT_SIZE, \n    STROKE_COLOR, \n    TEXT_COLOR, \n    BORDER_RADIUS, \n    MAX_BORDER_RADIUS, \n    LINE_WIDTH, \n    MAX_LINE_WIDTH \n} from '../../Constants/canvas.constants';\nimport { BoxComponent, CanvasComponent, CanvasData } from '../../Dtos/canvas.dtos';\nimport { canvasRender } from '../../Utils/canvas.utils';\nimport { getAvailableFontList } from '../../Utils/common.utils';\nimport Textarea from '../Inputs/Textarea/textarea.component';\nimport NumberInput from '../Inputs/NumberInput/numberInput.component';\nimport ColorPicker from '../Inputs/ColorPicker/colorPicker.component';\nimport SliderInput from '../Inputs/SliderInput/sliderInput.component';\nimport './settings.component.scss';\n\ninterface SettingsProps {\n    data: CanvasData;\n    canvasRef: React.RefObject<HTMLCanvasElement>;\n}\n\nconst Settings = ({ data = {}, canvasRef }: SettingsProps) => {\n\n    const [selection, setSelection] = useState<number>(-1);\n    const [component, setComponent] = useState<CanvasComponent>();\n    const [height, setHeight] = useState( data.height || CANVAS_HEIGHT );\n    const [fonts, setFonts] = useState<string[]>([]);\n\n    useEffect(() => {\n        // List of available fonts.\n        setFonts(getAvailableFontList());\n\n    }, [])\n\n    useEffect(() => {\n        if( canvasRef.current ) {\n            canvasRef.current.addEventListener('cwComponentSelected', handleSelectionChange );\n            // canvasRef.current.addEventListener('cwComponentMoving', handleComponentMoving );\n        }\n        return () => {\n            if( canvasRef.current ) {\n                canvasRef.current.removeEventListener('cwComponentSelected', handleSelectionChange );\n                // canvasRef.current.removeEventListener('cwComponentMoving', handleComponentMoving );\n            }\n        }\n    }, [ canvasRef.current, selection ])\n\n    useEffect(() => {\n        if( selection !== -1 && data.components && ! data.components[selection] ) {\n            setSelection( -1 );\n        }\n    }, [data])\n\n    const handleSelectionChange = ( event: CustomEvent ) => {\n        setSelection( -1 );\n        setSelection( event.detail.index );\n        setComponent( undefined );\n        setComponent( event.detail.component );\n    }\n\n    // const handleComponentMoving = ( event: CustomEvent ) => {\n    //     if( selection !== -1 ) {\n    //         setComponent(undefined);\n    //         setComponent( event.detail.components[selection] );\n    //     }\n    // }\n\n    let comp: any;\n    if( component && component.type === 'box' ) {\n        comp = component as BoxComponent;\n    }\n    \n    const handleDataChange = ( key: string, value: any ) => {\n        data[key] = value;\n        if( key === 'height' ) {\n            if( value && value < MIN_CANVAS_HEIGHT ) {\n                data[key] = MIN_CANVAS_HEIGHT;\n            } else if( ! value ) {\n                data[key] = CANVAS_HEIGHT;\n            }\n            setHeight( data[key] || CANVAS_HEIGHT );\n        }\n        canvasRender();\n    }\n\n    const handleComponentDataChange = ( key: string, value: any ) => {\n        if( selection !== -1 ) {\n            if( data.components && data.components[selection] ) {\n                const newComponent = { ...data.components[selection] }\n                newComponent[key] = value;\n                data.components[selection] = newComponent;\n\n                setComponent( data.components[selection] );\n                canvasRender();\n            }\n        }\n    }\n\n    return (\n        <div className='cw-settings' style={{ height: height }}>\n            { selection === -1 &&\n                <div className='canvas-settings'>\n                    <div className='section presentation'>\n                        <div className='title'>Canvas Settings</div>\n                        <div className='controls'>\n                            <div className='form-group'>\n                                <div className='form-control'>\n                                    <label>Background:</label>\n                                    <ColorPicker \n                                        type='fill'\n                                        value={data.background || CANVAS_BG} \n                                        colors={CANVAS_COLOR_LIST}\n                                        onChange={( value ) => handleDataChange( 'background',value ) } \n                                    />\n                                </div>\n                            </div>\n                            <div className='form-group'>\n                                <div className='form-control'>\n                                    <label>Height:</label>\n                                    <NumberInput\n                                        placeholder='Height'\n                                        min={MIN_CANVAS_HEIGHT}\n                                        value={data.height || CANVAS_HEIGHT}\n                                        onBlur={( value ) => handleDataChange( 'height',value )}\n                                    />\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            }\n            { selection !== -1 && \n                <div className='component-settings'>\n                    <div className='section presentation'>\n                        <div className='title'>Presentation</div>\n                        <div className='controls'>\n                            { comp && comp.type === 'box' && <div>\n                                <div className='form-group'>\n                                    <div className='form-control'>\n                                        <label>Fill:</label>\n                                        <ColorPicker \n                                            type='fill'\n                                            value={comp.fillColor || 'transparent'} \n                                            colors={CANVAS_COLOR_LIST}\n                                            onChange={( value ) => handleComponentDataChange( 'fillColor',value ) } \n                                        />\n                                    </div>\n                                    <div className='form-control'>\n                                        <label>Outline:</label>\n                                        <ColorPicker\n                                            type='stroke'\n                                            value={comp.strokeColor || STROKE_COLOR} \n                                            colors={CANVAS_COLOR_LIST}\n                                            onChange={( value ) => handleComponentDataChange( 'strokeColor',value ) } \n                                        />\n                                    </div>\n                                </div>\n                                <div className='form-group'>\n                                    <div className='form-control'>\n                                        <label>Outline Width: <strong>{ comp.lineWidth || BORDER_RADIUS } px</strong></label>\n                                        <SliderInput\n                                            value={ comp.lineWidth || LINE_WIDTH } \n                                            min={1}\n                                            max={MAX_LINE_WIDTH}\n                                            onAfterChange={( value ) => handleComponentDataChange( 'lineWidth', value )}\n                                        />\n                                    </div>\n                                </div>\n                                <div className='form-group'>\n                                    <div className='form-control'>\n                                        <label>Border Radius: <strong>{ typeof comp.borderRadius !== 'undefined' ? comp.borderRadius : BORDER_RADIUS } px</strong></label>\n                                        <SliderInput\n                                            value={ typeof comp.borderRadius !== 'undefined' ? comp.borderRadius : BORDER_RADIUS } \n                                            max={MAX_BORDER_RADIUS}\n                                            onAfterChange={( value ) => handleComponentDataChange( 'borderRadius', value )}\n                                        />\n                                    </div>\n                                </div>\n                            </div>}\n                        </div>\n                    </div>\n                    <div className='section text'>\n                        <div className='title'>Text</div>\n                        <div className='controls'>\n                            { comp && comp.type === 'box' && <div>\n                                <div className='form-group'>\n                                    <div className='form-control'>\n                                        <label>Title:</label>\n                                        <input \n                                            type='text' \n                                            placeholder='Title'\n                                            defaultValue={comp.title}\n                                            onChange={(e) => handleComponentDataChange( 'title', e.target.value )}\n                                        />\n                                    </div>\n                                </div>\n                                <div className='form-group'>\n                                    <div className='form-control'>\n                                        <label>Description:</label>\n                                        <Textarea \n                                            placeholder='Description' \n                                            value={comp.description} \n                                            onChange={(value) => handleComponentDataChange( 'description', value )} \n                                        />\n                                    </div>\n                                </div>\n                                <div className='form-group'>\n                                    <div className='form-control'>\n                                        <label>Font Size: <strong>{comp.fontSize || FONT_SIZE}px</strong></label>\n                                        <SliderInput\n                                            value={comp.fontSize || FONT_SIZE} \n                                            min={MIN_FONT_SIZE}\n                                            max={MAX_FONT_SIZE}\n                                            onAfterChange={( value ) => handleComponentDataChange( 'fontSize', value )}\n                                        />\n                                    </div>\n                                </div>\n                                <div className='form-group'>\n                                    <div className='form-control'>\n                                        <label>Font Family:</label>\n                                        <select defaultValue={comp.fontFamily || FONT_FAMILY} onChange={( e ) => handleComponentDataChange( 'fontFamily', e.target.value ) }>\n                                            { fonts.length > 0 && fonts.map( ( font ) => (\n                                                <option key={font} value={font}>{font}</option>\n                                            ) ) }\n                                        </select>\n                                    </div>\n                                </div>\n                                <div className='form-group'>\n                                    <div className='form-control'>\n                                        <label>Text Color:</label>\n                                        <ColorPicker\n                                            type='fill'\n                                            value={comp.textColor || TEXT_COLOR} \n                                            colors={CANVAS_COLOR_LIST}\n                                            onChange={( value ) => handleComponentDataChange( 'textColor',value ) } \n                                        />\n                                    </div>\n                                </div>\n                            </div>}\n                        </div>\n                    </div>\n                </div>\n            }\n        </div>\n    )\n}\n\nexport default Settings\n","import React, { createRef, useEffect, useState } from 'react'\nimport { BoxComponent, CanvasData } from './Dtos/canvas.dtos';\nimport { DestroyCanvas, InitCanvas } from './Utils/canvas.utils';\nimport { IsEqualObject } from './Utils/common.utils';\nimport Toolbar from './Components/Toolbar/toolbar.component';\nimport Settings from './Components/Settings/settings.component';\nimport './styles.scss'\n\ninterface Props {\n    mode?: 'editor' | 'viewer';\n    data?: CanvasData;\n    onDataChange?( data: CanvasData ): void;\n}\n\nconst ConvasWorkflow = ({ mode = 'editor', data = {}, onDataChange }: Props) => {\n\n    const [cwMode, setCwMode] = useState(mode);\n    const [cwData, setCwData] = useState<CanvasData>({});\n\n    const canvasRef = createRef<HTMLCanvasElement>();\n    const parentRef = createRef<HTMLDivElement>();\n\n    useEffect(() => {\n        if( cwMode !== mode ) {\n            setCwMode(mode);\n        }\n        if( ! IsEqualObject( data, cwData ) ) {\n            setCwData(data);\n        }\n    }, [mode, data]);\n\n    useEffect(() => {\n        if( canvasRef.current && parentRef.current ) {\n            InitCanvas({\n                parent: parentRef.current,\n                canvas: canvasRef.current,\n                mode: cwMode,\n                data: cwData,\n                onDataChange,\n            });\n        }\n\n        return () => {\n            DestroyCanvas();\n        }\n    }, [canvasRef, parentRef, cwMode, cwData, cwData.components ])\n\n    const addRandomBox = () => {\n        const randomX = Math.floor( Math.random() * ( canvasRef.current && parseInt( canvasRef.current.style.width ) || 100 ) );\n        const randomY = Math.floor( Math.random() * ( canvasRef.current && parseInt( canvasRef.current.style.height ) || 100 ) );\n        // const randomRadius = Math.floor( Math.random() * 15 );\n\n        const comp: BoxComponent = {\n            type: 'box',\n            title: 'Random',\n            description: 'Random ' + randomX + ':' + randomY,\n            x: randomX,\n            y: randomY,\n            w: 150,\n            h: 100,\n            fillColor: '#ffffff',\n            strokeColor: '#ccc',\n            borderRadius: 2,\n        }\n        setCwData( { ...cwData, components: [ ...cwData?.components || [], comp ] });\n    }\n\n    const clearAll = () => {\n        setCwData( { ...cwData, components: [] } );\n    }\n\n    return (\n        <div className={`canvas-workflow`} >\n            <Toolbar />\n            <div className='cw-wrapper' ref={parentRef}>\n                <canvas ref={canvasRef} tabIndex={1}></canvas>\n            </div>\n            <div>\n                <Settings data={cwData} canvasRef={canvasRef} />\n                <button onClick={addRandomBox}>Add Random Box</button>\n                <button onClick={clearAll}>Clear All</button>\n            </div>\n        </div>\n    )\n}\n\nexport default ConvasWorkflow;","import React, { useState } from 'react'\n\nimport CanvasWorkflow from 'canvas-workflow'\nimport { CanvasData } from 'canvas-workflow/dist/Dtos/canvas.dtos'\nimport 'canvas-workflow/dist/index.css'\n\nconst App = () => {\n    const [ data, setData ] = useState<CanvasData>({\n        components:[\n            { \n                type: 'box',\n                title: 'Begin',\n                description: 'Begin',\n                x: 100,\n                y: 100,\n                w: 150,\n                h: 100,\n                lineWidth: 1,\n                fillColor: '#ffffff',\n            }\n        ]\n    });\n\n    const dataChangeHandle = ( data: CanvasData ) => {\n        setData( data );\n    }\n\n    return (\n        <div>\n            <CanvasWorkflow mode='editor' data={data} onDataChange={dataChangeHandle} />\n        </div>\n    )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}