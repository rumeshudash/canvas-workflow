(this["webpackJsonpcanvas-workflow-example"]=this["webpackJsonpcanvas-workflow-example"]||[]).push([[0],[,,,,function(e,t,n){e.exports=n(11)},function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(5);var r=n(0),o=n.n(r),i=n(2),a=n.n(i),l=n(3);function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d=["nwse-resize","ns-resize","nesw-resize","ew-resize","nwse-resize","ns-resize","nesw-resize","ew-resize"];function f(e,t){var n=Object.keys(e||{}),r=Object.keys(t||{});if(n.length!==r.length)return!1;for(var o in n)if(n[o]!==r[o])return!1;for(var i=0,a=n;i<a.length;i++){var l=a[i];if(Array.isArray(e[l])){if(e[l].length!==t[l].length)return!1;for(var c=0;c<e[l].length;c++)if(e[l][c]!==t[l][c])return!1}else if(e[l]!==t[l])return!1}return!0}var v,m,h,y,p,x,w,b,g,E,C=function(e){for(var t=[],n=1;n<=8;n++){var r={x:0,y:0,w:7,h:7};[1,7,8].includes(n)?r.x=e.x-3-3.5:[2,6].includes(n)?r.x=e.x+e.w/2+1.5-3.5:[3,4,5].includes(n)&&(r.x=e.x+e.w+3-3.5),[1,2,3].includes(n)?r.y=e.y-3-3.5:[4,8].includes(n)?r.y=e.y+e.h/2+1.5-3.5:[5,6,7].includes(n)&&(r.y=e.y+e.h+3-3.5),t.push(r)}return t},k=!1,S=!1,j=!1,O=!1,R=-1,T=-1,L={x:0,y:0},N={x:0,y:0,w:0,h:0},z={x:0,y:0},W=function(){m&&(m.removeEventListener("mousedown",A),m.removeEventListener("mousemove",P),m.removeEventListener("keypress",D))},A=function(e){if(h.length){var t=q(e);if(j&&!O)return O=!0,z=c({},t),y=h.map((function(e){return c({},e)})),m.style.cursor="grabbing",void m.addEventListener("mouseup",B);for(var n,r=[].concat(h).reverse(),o=function(){var e=n.value,o={x:e.x,y:e.y,w:0,h:0};switch(e.type){case"box":var i=e;o.w=i.w,o.h=i.h}if(!k&&M(t.x,t.y,o))return k=!0,R=function(e,t){var n=e.length,r=e.indexOf(t);return-1===r?-1:n-r-1}(r,e),L.x=t.x-e.x,L.y=t.y-e.y,m.addEventListener("mouseup",B),"break";if(!S&&-1!==R&&(C(o).every((function(e,n){return!M(t.x,t.y,e)||(S=!0,z=c({},t),N=c({},o),T=n,m.addEventListener("mouseup",B),!1)})),S))return"break"},i=u(r);!(n=i()).done;){if("break"===o())break}k||S||(R=-1,T=-1),F()}},P=function(e){var t=q(e);if(j){if(O){for(var n=z.x-t.x,r=z.y-t.y,o=0;o<h.length;o++)h[o].x=y[o].x-n,h[o].y=y[o].y-r;v()}}else if(k&&!S&&-1!==R)h[R].x=t.x-L.x,h[R].y=t.y-L.y,v();else if(S&&-1!==R){var i=z.x-t.x,a=z.y-t.y,l=t.x-z.x,c=t.y-z.y;[0,6,7].includes(T)&&(h[R].x=N.x-i,h[R].w=N.w+i),[0,1,2].includes(T)&&(h[R].y=N.y-a,h[R].h=N.h+a),[2,3,4].includes(T)&&(h[R].w=N.w+l),[4,5,6].includes(T)&&(h[R].h=N.h+c),h[R].w<=50&&(h[R].w=50),h[R].h<=50&&(h[R].h=50),v()}else h.every((function(e,n){var r={x:e.x,y:e.y,w:0,h:0};switch(e.type){case"box":var o=e;r.w=o.w,r.h=o.h}if(M(t.x,t.y,r))return m.style.cursor="move",!1;m.style.cursor="default";var i=!1;n===R&&C(r).every((function(e,n){return!M(t.x,t.y,e)||(m.style.cursor=d[n]||"move",i=!0,!1)}));return!i}))},B=function e(){O&&(m.style.cursor="grab"),k=!1,S=!1,O=!1,y=[],m.removeEventListener("mouseup",e)},D=function(e){e.preventDefault()," "!==e.key||j||(m.style.cursor="grab",j=!0)},I=function(e){" "===e.key&&(j=!1,O=!1,y=[],m.style.cursor="default")},M=function(e,t,n){return e>n.x&&t>n.y&&e<n.w+n.x&&t<n.h+n.y},q=function(e){var t=m.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},F=function(){m&&m.dispatchEvent(new CustomEvent("cwComponentSelected",{detail:{index:R,component:h[R]}}))},J=function(e,t,n,r,o,i){var a=function(e){return"number"!==typeof e?c({},{tl:0,tr:0,br:0,bl:0},e):{tl:e,tr:e,br:e,bl:e}}(i);e.moveTo(t+a.tl,n),e.lineTo(t+r-a.tr,n),e.quadraticCurveTo(t+r,n,t+r,n+a.tr),e.lineTo(t+r,n+o-a.br),e.quadraticCurveTo(t+r,n+o,t+r-a.br,n+o),e.lineTo(t+a.bl,n+o),e.quadraticCurveTo(t,n+o,t,n+o-a.bl),e.lineTo(t,n+a.tl),e.quadraticCurveTo(t,n,t+a.tl,n),e.closePath()},U=function(e,t,n,r,o,i){if((i=i||0)<=0)e.fillText(t,n,r);else{for(var a=t.split(" "),l=0,c=1;a.length>0&&c<=a.length;){var s=a.slice(0,c).join(" ");e.measureText(s).width>i?(1==c&&(c=2),e.fillText(a.slice(0,c-1).join(" "),n,r+o*l),l++,a=a.splice(c-1),c=1):c++}c>0&&e.fillText(a.join(" "),n,r+o*l)}},V={background:"#f5f5f5",hoverColor:"#0000ff",textColor:"#000000",strokeColor:"#cccccc",selectionStrokeColor:"#7f7f7f",selectionLineWidth:1,lineWidth:1,fontSize:16,fontFamily:"Arial",borderRadius:3},X={},Y=function(e){var t,n,r=e.parent,o=e.canvas,i=e.mode,a=e.data,l=e.onDataChange;p=r,x=o,g=i||"editor",w=o.getContext("2d"),l&&(b=l),a&&(X=a),H(!1),"editor"===g&&null!==(t=X)&&void 0!==t&&null!==(n=t.components)&&void 0!==n&&n.length?function(e,t,n){h=t,v=n,(m=e).addEventListener("mousedown",A),m.addEventListener("mousemove",P),m.addEventListener("keydown",D),m.addEventListener("keyup",I)}(x,X.components,H):W(),window.addEventListener("resize",G),x.addEventListener("cwComponentSelected",$)},$=function(e){E!==e.detail.index&&(E=e.detail.index,H(!1))},G=function(e,t){var n,r=this;return void 0===t&&(t=300),function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];window.clearTimeout(n),n=window.setTimeout((function(){e.apply(r,i)}),t)}}((function(){return H()})),H=function(e){if(void 0===e&&(e=!0),p&&x&&w){var t,n=p.getBoundingClientRect(),r=function(e){return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}(w);x.width=n.width*r,x.height=(X.height||500)*r,x.style.width=n.width+"px",x.style.height=(X.height||500)+"px",w.setTransform(r,0,0,r,0,0),x&&w&&w.clearRect(0,0,x.width,x.height),K(),null!==(t=X)&&void 0!==t&&t.components&&X.components.forEach((function(e){Q(e)})),e&&b(X)}},K=function(){x&&w&&(w.translate(.5,.5),w.fillStyle=X.background||V.background,w.fillRect(0,0,x.width,x.height))},Q=function(e){switch(e.type){case"box":!function(e,t,n){if(n){var r=e.fontSize||t.fontSize;n.save(),n.beginPath(),J(n,e.x,e.y,e.w,e.h,e.borderRadius||t.borderRadius),e.fillColor&&(n.fillStyle=e.fillColor,n.fill()),n.lineWidth=e.lineWidth||t.lineWidth,n.strokeStyle=e.strokeColor||t.strokeColor,n.stroke(),n.clip(),n.font="bold "+r+"px "+e.fontFamily,n.fillStyle=e.textColor||t.textColor,n.fillText(e.title,e.x+5+n.lineWidth,e.y+5+r+n.lineWidth-5),e.description&&(n.font=r+"px "+e.fontFamily,U(n,e.description,e.x+5+n.lineWidth,e.y+10+2*r+n.lineWidth-5,r,e.w-10-n.lineWidth)),n.restore()}}(e,V,w)}!function(e,t,n,r,o,i){var a;if(i&&"editor"===o&&n>-1&&null!==(a=t.components)&&void 0!==a&&a.length&&n===t.components.indexOf(e)){var l={x:e.x,y:e.y,w:0,h:0};switch(e.type){case"box":var c=e;l.w=c.w,l.h=c.h}i.save(),i.beginPath(),i.lineWidth=t.selectionLineWidth||r.selectionLineWidth,i.setLineDash([5,5]),i.strokeStyle=t.selectionStrokeColor||r.selectionStrokeColor,i.rect(l.x-3,l.y-3,l.w+6,l.h+6),i.stroke(),i.restore(),i.save(),i.beginPath(),i.fillStyle=t.selectionStrokeColor||r.selectionStrokeColor;for(var s,d=u(C(l));!(s=d()).done;){var f=s.value;i.rect(f.x,f.y,f.w,f.h)}i.fill(),i.restore()}}(e,X,E,V,g,w)},Z=function(e){var t=e.value,n=e.placeholder,i=e.onChange,a=Object(r.useState)(t),l=a[0],c=a[1];return o.a.createElement("div",{className:"textarea-wrap","data-replicated-value":l},o.a.createElement("textarea",{placeholder:n,onChange:function(e){c(e.target.value),i&&i(e.target.value)},value:l}))},_=function(e){var t=e.data,n=void 0===t?{}:t,i=e.canvasRef,a=Object(r.useState)(-1),l=a[0],c=a[1],s=Object(r.useState)(),u=s[0],d=s[1];Object(r.useEffect)((function(){return i.current&&i.current.addEventListener("cwComponentSelected",v),function(){i.current&&i.current.removeEventListener("cwComponentSelected",v)}}),[i,l]),Object(r.useEffect)((function(){-1!==l&&n.components&&!n.components[l]&&c(-1)}),[n]);var f,v=function(e){c(-1),c(e.detail.index),d(e.detail.component)};u&&"box"===u.type&&(f=u);var m=function(e,t){-1!==l&&f&&(Object.keys(f).includes(e)&&(f[e]=t),n.components&&(n.components[l]=f,H()))};return o.a.createElement("div",{className:"cw-settings",style:{height:n.height||500}},-1!==l&&o.a.createElement("div",{className:"component-settings"},o.a.createElement("div",{className:"section presentation"},o.a.createElement("div",{className:"title"},"Presentation"),o.a.createElement("div",{className:"controls"})),o.a.createElement("div",{className:"section text"},o.a.createElement("div",{className:"title"},"Text"),o.a.createElement("div",{className:"controls"},f&&"box"===f.type&&o.a.createElement("div",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("div",{className:"form-control"},o.a.createElement("label",null,"Title:"),o.a.createElement("input",{type:"text",placeholder:"Title",defaultValue:f.title,onChange:function(e){return m("title",e.target.value)}}))),o.a.createElement("div",{className:"form-group"},o.a.createElement("div",{className:"form-control"},o.a.createElement("label",null,"Description:"),o.a.createElement(Z,{placeholder:"Description",value:f.description,onChange:function(e){return m("description",e)}}))))))))},ee=function(e){var t=e.mode,n=void 0===t?"editor":t,i=e.data,a=void 0===i?{}:i,l=e.onDataChange,s=Object(r.useState)(n),u=s[0],d=s[1],v=Object(r.useState)(a),m=v[0],h=v[1],y=Object(r.createRef)(),p=Object(r.createRef)();Object(r.useEffect)((function(){u!==n&&d(n),f(a,m)||h(a)}),[n,a]),Object(r.useEffect)((function(){f(a,m)||"function"!==typeof l||l(m)}),[m]),Object(r.useEffect)((function(){return y.current&&p.current&&Y({parent:p.current,canvas:y.current,mode:u,data:m,onDataChange:l}),function(){window.removeEventListener("resize",G),x.removeEventListener("cwComponentSelected",$),W()}}),[y,p,u,m]);return o.a.createElement("div",{className:"canvas-workflow"},o.a.createElement("div",{className:"cw-tools"},o.a.createElement("div",{className:""},o.a.createElement("div",null,"Tool Box"))),o.a.createElement("div",{className:"cw-wrapper",ref:p},o.a.createElement("canvas",{ref:y,tabIndex:1})),o.a.createElement("div",null,o.a.createElement(_,{data:m,canvasRef:y}),o.a.createElement("button",{onClick:function(){var e,t,n=Math.floor(Math.random()*((null===(e=y.current)||void 0===e?void 0:e.width)||100)),r=Math.floor(Math.random()*((null===(t=y.current)||void 0===t?void 0:t.height)||100)),o={type:"box",title:"Random",description:"Random "+n+":"+r,x:n,y:r,w:150,h:100,fillColor:"#ffffff",strokeColor:"#ccc",borderRadius:2};h(c({},m,{components:[].concat((null===m||void 0===m?void 0:m.components)||[],[o])}))}},"Add Random Box"),o.a.createElement("button",{onClick:function(){h(c({},m,{components:[]}))}},"Clear All")))},te=(n(10),function(){var e=Object(r.useState)({components:[{type:"box",title:"Begin",description:"Begin",x:100,y:100,w:150,h:100,fillColor:"#ffffff",lineWidth:1,borderRadius:2}]}),t=Object(l.a)(e,2),n=t[0],i=t[1];return o.a.createElement("div",null,o.a.createElement(ee,{mode:"editor",data:n,onDataChange:function(e){i(e),console.log(e)}}))});a.a.render(o.a.createElement(te,null),document.getElementById("root"))}],[[4,1,2]]]);
//# sourceMappingURL=main.3a0f5609.chunk.js.map