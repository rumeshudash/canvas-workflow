(this["webpackJsonpcanvas-workflow-example"]=this["webpackJsonpcanvas-workflow-example"]||[]).push([[0],{10:function(e,t,n){},15:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);n(10);var o=n(0),r=n.n(o),a=n(8),i=n.n(a),c=n(4),l=n(5),u=n(6),s=n(1);var d,f,v,m,h,y,b,x,w=function(e,t){var n=e.length,o=e.indexOf(t);return-1===o?-1:n-o-1},p=!1,E=-1,g={x:0,y:0},C=function(){f&&(f.removeEventListener("mousedown",O),f.removeEventListener("mousemove",j))},O=function(e){if(d.length){var t,n=Object(u.a)(d).reverse(),o=T(e),r=Object(l.a)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(!p&&"box"===a.type&&S(o.x,o.y,a)){p=!0,E=w(n,a),g.x=o.x-a.x,g.y=o.y-a.y,f.addEventListener("mouseup",k);break}}}catch(i){r.e(i)}finally{r.f()}L()}},j=function(e){var t=T(e);if(f.style.cursor="default",-1!==E)d[E].x=t.x-g.x,d[E].y=t.y-g.y,v(),f.style.cursor="move";else{var n,o=Object(l.a)(d);try{for(o.s();!(n=o.n()).done;){var r=n.value;if("box"===r.type&&S(t.x,t.y,r)){f.style.cursor="move";break}}}catch(a){o.e(a)}finally{o.f()}}},k=function e(){p=!1,E=-1,f.removeEventListener("mouseup",e)},S=function(e,t,n){return e>n.x&&t>n.y&&e<n.w+n.x&&t<n.h+n.y},T=function(e){var t=f.getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},L=function(){if(f){var e=new CustomEvent("cwComponentSelected",{detail:{index:E,component:d[E]}});f.dispatchEvent(e)}},R=500,W="#efefef",M="#000000",B="#7f7f7f",N=1,q=1,D=16,P=3,z={},A=function(e){var t,n,o=e.parent,r=e.canvas,a=e.mode,i=e.data;m=o,h=r,b=a||"editor",y=r.getContext("2d"),i&&(z=i),I(),"editor"===b&&null!==(t=z)&&void 0!==t&&null!==(n=t.components)&&void 0!==n&&n.length?function(e,t,n){d=t,v=n,(f=e).addEventListener("mousedown",O),f.addEventListener("mousemove",j)}(h,z.components,I):C(),window.addEventListener("resize",F),h.addEventListener("cwComponentSelected",J)},J=function(e){x=e.detail.index,I()},F=function(e){var t,n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];window.clearTimeout(t),t=window.setTimeout((function(){e.apply(n,a)}),o)}}((function(){return I()})),I=function(){if(m&&h&&y){var e,t=m.getBoundingClientRect();h.width=t.width,h.height=z.height||R,h&&y&&y.clearRect(0,0,h.width,h.height),X(),null!==(e=z)&&void 0!==e&&e.components&&z.components.forEach((function(e){Y(e)}))}},X=function(){h&&y&&(y.translate(.5,.5),y.fillStyle=z.background||W,y.fillRect(0,0,h.width,h.height))},Y=function(e){switch(e.type){case"box":H(e)}G(e)},G=function(e){var t;if(y&&"editor"===b&&x>-1&&null!==(t=z.components)&&void 0!==t&&t.length&&x===z.components.indexOf(e)){var n={x:e.x,y:e.y,w:0,h:0};switch(e.type){case"box":var o=e;n.w=o.w,n.h=o.h}y.save(),y.beginPath(),y.lineWidth=z.selectionLineWidth||N,y.setLineDash([5,5]),y.strokeStyle=z.selectionStrokeColor||B,y.rect(n.x-3,n.y-3,n.w+6,n.h+6),y.stroke(),y.restore(),y.save(),y.beginPath(),y.fillStyle=z.selectionStrokeColor||B;var r,a=function(e,t,n){for(var o=[],r=1;r<=8;r++){var a={x:0,y:0,w:n,h:n};[1,7,8].includes(r)?a.x=e.x-t-n/2:[2,6].includes(r)?a.x=e.x+e.w/2+t/2-n/2:[3,4,5].includes(r)&&(a.x=e.x+e.w+t-n/2),[1,2,3].includes(r)?a.y=e.y-t-n/2:[4,8].includes(r)?a.y=e.y+e.h/2+t/2-n/2:[5,6,7].includes(r)&&(a.y=e.y+e.h+t-n/2),o.push(a)}return o}(n,3,7),i=Object(l.a)(a);try{for(i.s();!(r=i.n()).done;){var c=r.value;y.rect(c.x,c.y,c.w,c.h)}}catch(u){i.e(u)}finally{i.f()}y.fill(),y.restore()}},H=function(e){if(y){var t=e.fontSize||D;y.save(),y.beginPath(),K(y,e.x,e.y,e.w,e.h,e.borderRadius),e.fillColor&&(y.fillStyle=e.fillColor,y.fill()),y.lineWidth=e.lineWidth||q,y.strokeStyle=e.strokeColor||e.fillColor||M,y.stroke(),y.clip(),y.font="".concat(t,"px ").concat(e.fontFamily),y.fillStyle=e.textColor||M,y.fillText(e.text,e.x+5+y.lineWidth,e.y+5+t+y.lineWidth-5),y.restore()}},K=function(e,t,n,o,r,a){var i=function(e){return"number"!==typeof e?Object(s.a)(Object(s.a)({},{tl:0,tr:0,br:0,bl:0}),e):{tl:e,tr:e,br:e,bl:e}}(a||P);e.moveTo(t+i.tl,n),e.lineTo(t+o-i.tr,n),e.quadraticCurveTo(t+o,n,t+o,n+i.tr),e.lineTo(t+o,n+r-i.br),e.quadraticCurveTo(t+o,n+r,t+o-i.br,n+r),e.lineTo(t+i.bl,n+r),e.quadraticCurveTo(t,n+r,t,n+r-i.bl),e.lineTo(t,n+i.tl),e.quadraticCurveTo(t,n,t+i.tl,n),e.closePath()},Q=function(e){var t=e.mode,n=void 0===t?"editor":t,a=e.defaultData,i=e.data,l=(e.onDataChange,Object(o.useState)(n)),d=Object(c.a)(l,2),f=d[0],v=d[1],m=Object(o.useState)(i||a),y=Object(c.a)(m,2),b=y[0],x=y[1],w=Object(o.createRef)(),p=Object(o.createRef)();Object(o.useEffect)((function(){v(n),x(i)}),[n,i]),Object(o.useEffect)((function(){return w.current&&p.current&&A({parent:p.current,canvas:w.current,mode:f,data:b}),function(){window.removeEventListener("resize",F),h.removeEventListener("cwComponentSelected",J),C()}}),[w,p,f,b]);return r.a.createElement("div",{className:"canvas-workflow"},r.a.createElement("div",{className:"cw-tools"},r.a.createElement("div",{className:""},r.a.createElement("div",null,"Tool Box"))),r.a.createElement("div",{className:"cw-wrapper",ref:p},r.a.createElement("canvas",{ref:w})),r.a.createElement("div",{className:"cw-settings"},r.a.createElement("div",{onClick:function(){return v("viewer")}},"settings"),r.a.createElement("button",{onClick:function(){var e,t,n=Math.floor(Math.random()*((null===(e=w.current)||void 0===e?void 0:e.width)||100)),o=Math.floor(Math.random()*((null===(t=w.current)||void 0===t?void 0:t.height)||100)),r={type:"box",x:n,y:o,w:100,h:100,fillColor:"green",text:"Random "+n+":"+o,borderRadius:Math.floor(15*Math.random())};x(Object(s.a)(Object(s.a)({},b),{},{components:[].concat(Object(u.a)((null===b||void 0===b?void 0:b.components)||[]),[r])}))}},"Add Random Box"),r.a.createElement("button",{onClick:function(){x(Object(s.a)(Object(s.a)({},b),{},{components:[]}))}},"Clear All")))},U=(n(15),function(){var e=Object(o.useState)(),t=Object(c.a)(e,2),n=t[0],a=t[1];Object(o.useEffect)((function(){a({components:[{type:"box",text:"Rumesh",x:100,y:100,w:150,h:100,fillColor:"red",strokeColor:"green",lineWidth:1,borderRadius:5}]})}),[]);return r.a.createElement("div",null,r.a.createElement(Q,{mode:"editor",data:n,onDataChange:function(e){a(e)}}))});i.a.render(r.a.createElement(U,null),document.getElementById("root"))},9:function(e,t,n){e.exports=n(16)}},[[9,1,2]]]);
//# sourceMappingURL=main.27de93d8.chunk.js.map